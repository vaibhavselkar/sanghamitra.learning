<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Reading Comprehension Topics</title>
  <style>
    /* Page Styles */
    body {
      font-family: Arial, sans-serif;
      background-color: #f8f9fa;
      margin: 0;
      padding: 0;
    }

    .container {
      width: 80%;
      margin: auto;
    }

    .topic-section {
      background-color: white;
      border-radius: 10px;
      box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1);
      padding: 20px;
    }

    .topic-section h2 {
      margin-top: 0;
    }

    .topic-list {
      margin-top: 20px;
    }

    .topic-item {
      display: flex;
      justify-content: space-between;
      align-items: center;
      padding: 15px;
      border-bottom: 1px solid #dee2e6;
    }

    .topic-item:last-child {
      border-bottom: none;
    }

    .course-item {
      display: flex;
      flex-direction: column;
      width: 100%;
    }

    .course-content {
      display: flex;
      flex-direction: column;
    }

    .course-content .d-flex {
      display: flex;
      justify-content: space-between;
      align-items: center;
    }

    .course-content .progress {
      background-color: #e9ecef;
      border-radius: 5px;
      height: 10px;
      margin: 10px 0;
    }

    .course-content .progress-bar {
      background-color: #28a745;
      border-radius: 5px;
      height: 100%;
    }

    .course-content .category {
      background-color: #007bff;
      color: white;
      border: none;
      padding: 5px 10px;
      border-radius: 5px;
      cursor: pointer;
    }

    .course-content .category:hover {
      background-color: #0056b3;
    }

    .course-content .topiclevel {
      font-size: 1.2rem;
      font-weight: bold;
      color: #555;
    }

    .course-content .practice-button {
      margin-top: 10px;
      background-color: #28a745;
      color: white;
      border: none;
      padding: 8px 12px;
      border-radius: 5px;
      cursor: pointer;
    }

    .course-content .practice-button:hover {
      background-color: #28a745;
    }

    .intro-section {
      background: linear-gradient(to right, #f7f9fc, #f1f1f1); /* Subtle gradient */
      padding: 2rem;
      border-radius: 8px;
      box-shadow: 0 4px 10px rgba(0, 0, 0, 0.1); /* Soft shadow */
      text-align: center;
      margin-bottom: 2rem;
    }

    .intro-title {
      font-size: 1.8rem;
      font-weight: bold;
      color: #333;
      margin-bottom: 1rem;
    }

    .intro-text {
      font-size: 1.025rem; /* Slightly larger than normal text */
      line-height: 1.8;
      color: #555;
    }

    .intro-text strong {
      color: #00070e; /* Highlight brand name with primary color */
    }

    @media (max-width: 768px) {
      .intro-section {
        padding: 1.5rem;
      }

      .intro-title {
        font-size: 1.5rem;
      }

      .intro-text {
        font-size: 1rem;
      }
    }
  </style>

    <link href="../assets/img/favicon.png" rel="icon">
    <link href="../assets/img/apple-touch-icon.png" rel="apple-touch-icon">

    <!-- Fonts -->
    <link href="https://fonts.googleapis.com" rel="preconnect">
    <link href="https://fonts.gstatic.com" rel="preconnect" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Open+Sans:wght@300;400;500;600;700;800&family=Poppins:wght@100;200;300;400;500;600;700;800&display=swap" rel="stylesheet">

    <!-- Vendor CSS Files -->
    <link href="../assets/vendor/bootstrap/css/bootstrap.min.css" rel="stylesheet">
    <link href="../assets/vendor/bootstrap-icons/bootstrap-icons.css" rel="stylesheet">
    <link href="../assets/vendor/aos/aos.css" rel="stylesheet">
    <link href="../assets/vendor/glightbox/css/glightbox.min.css" rel="stylesheet">
    <link href="../assets/vendor/swiper/swiper-bundle.min.css" rel="stylesheet">

    <!-- Main CSS File -->
    <link href="../assets/css/main.css" rel="stylesheet">



</head>
<body>

    <header id="header" class="header d-flex align-items-center sticky-top">
        <div class="container-fluid container-xl position-relative d-flex align-items-center">
    
          <a href="../index.html" class="logo d-flex align-items-center me-auto">
            <img src="../img/sbi.logo.png" alt="Logo" width="80" height="80"> 
            <h1 class="">Sanghamitra Learning</h1>
          </a>
    
          <nav id="navmenu" class="navmenu">
            <div id="navbar-placeholder"></div>
            <i class="mobile-nav-toggle d-xl-none bi bi-list"></i>
          </nav>
    
        </div>
    </header>

 <div class="page-title">
    <div class="heading">
      <div class="container">
        <div class="row d-flex justify-content-center text-center">
          <div class="col-lg-8">
            <h1>Reading Comprehension</h1>
            <p class="mb-0">At <strong>Sanghamitra Learning</strong>, we focus on making reading comprehension both effective and engaging. That’s why we’ve created a collection of passages on diverse topics like science, art, and politics. This variety helps learners stay interested while developing essential skills like critical thinking and pattern recognition. By exploring different subjects and levels, you’ll not only improve your understanding but also make reading more enjoyable. Start your journey to stronger comprehension today!</p>
          </div>
        </div>
        </div>
      </div>
      <nav class="breadcrumbs">
          <ol>
            <li><a href="index.html">Home</a></li>
            <li><a href="../english.html">English</a></li>
            <li><a href="reading_comprehension.html">Reading Comprehension</a></li>
            <li class="current">RC Topics</li>
          </ol>
      </nav>
    
 </div>

  </div>
      <div class="container">
      <div id="topic-progress-list" class="topic-list">
        <!-- List items will be inserted here by JavaScript -->
      </div>
    </div>
  </div>

  <footer id="footer" class="footer position-relative">

    <div class="container footer-top">
      <div class="row gy-4">
        <div class="col-lg-4 col-md-6 footer-about">
          <a href="index.html" class="logo d-flex align-items-center">
            <span class="">Sanghamitra Learning</span>
          </a>
          <div class="footer-contact pt-3">
            <p>GacchiBowli</p>
            <p>Hyderabad, TS 500032</p>
            <p class="mt-3"><strong>Phone:</strong> <span>+91 7020102729</span></p>
            <p><strong>Email:</strong> <span>sanghamitra.learnworlds@gmail.com</span></p>
          </div>
          <div class="social-links d-flex mt-4">
            <a href=""><i class="bi bi-twitter"></i></a>
            <a href=""><i class="bi bi-facebook"></i></a>
            <a href=""><i class="bi bi-instagram"></i></a>
            <a href=""><i class="bi bi-linkedin"></i></a>
          </div>
        </div>

        <div class="col-lg-4 col-md-12 footer-newsletter">
          <!-- Optional content -->
        </div>

      </div>
    </div>

    <div class="container copyright text-center mt-4">
      <p>© <span>Copyright</span> <strong class="px-1">Sanghamitra Learning</strong> <span>All Rights Reserved</span></p>
      <div class="credits">
        Designed by <a href="index.html">Sanghamitra</a>
      </div>
    </div>

  </footer>

  <script>
    let username = '';
    let email = '';

    // Default list of reading comprehension topics
    const topicsList = [
      { topic: 'Science', displayName: 'Science' },
      { topic: 'Art', displayName: 'Art' },
      { topic: 'Politics', displayName: 'Politics' },
      { topic: 'Astronomy', displayName: 'Astronomy' },
      { topic: 'Anime', displayName: 'Anime' },
      { topic: 'Cars', displayName: 'Cars' }
    ];


    async function fetchSessionInfo() {
      try {
        const response = await fetch('https://sanghamitra-learnworld.vercel.app/api/session-info', {
          credentials: 'include'
        });
        if (response.ok) {
          const data = await response.json();
          username = data.username;
          email = data.email;
          console.log(username, email);
          fetchUserProgress(); // Fetch and display topic progress after retrieving user info
        } else {
          window.location.href = '../user_login.html';
        }
      } catch (error) {
        console.error('Error fetching session info:', error);
      }
    }


    async function fetchUserProgress() {
      try {
        // Fetch user reading comprehension scores
        const response = await fetch(`https://sanghamitra-learnworld.vercel.app/api/readingcomprehensionscore?email=${email}`);
        let data = {};

        if (response.ok) {
          data = await response.json();
        } else {
          console.warn('No progress data found. Defaulting to empty data.');
        }

        // Call populateTopics with either the fetched data or an empty object
        populateTopics(data.topics || {});
      } catch (error) {
        console.error('Error fetching user progress:', error);

        // If an error occurs, populate topics with defaults
        populateTopics({});
      }
    }

    function populateTopics(topicsData) {
      const topicListContainer = document.getElementById('topic-progress-list');

      // Clear existing content
      topicListContainer.innerHTML = '';

      // Iterate over predefined topics
      topicsList.forEach(({ topic, displayName }) => {
        const topicData = topicsData[topic] || {
          current_level: topicsData[topic]?.current_level || 'Easy',
          solvedPassages: [],
          consecutivePerfectScores: 0,
          scores: [], // Default to an empty array if scores are missing
        };

        // Ensure scores is an array to avoid errors
        const scores = Array.isArray(topicData.scores) ? topicData.scores : [];

        // Calculate progress
        const progress = scores.length
          ? (scores.reduce((acc, score) => acc + score.scorePercentage, 0) / scores.length).toFixed(2)
          : 0;

        // Total solved passages and consecutive perfect scores
        const totalSolved = topicData.solvedPassages.length;
        const consecutivePerfect = topicData.consecutivePerfectScores || 0;

        // Generate HTML for the topic
        const topicItemHTML = `
          <div class="topic-item">
            <div class="course-item">
              <div class="course-content">
                <div class="d-flex justify-content-between align-items-center">
                  <button class="category" onclick="location.href='RC_assess.html?topic=${topic}&level=${topicData.topiclevel}'">${displayName}</button>
                  <span class="topiclevel">${topicData.current_level}</span>
                </div>
                
                <div class="d-flex justify-content-between align-items-center">
                  <span>Total Solved: ${totalSolved}</span>
                  <span>Ace: ${consecutivePerfect}</span>
                </div>
              </div>
            </div>
          </div>
        `;

        topicListContainer.insertAdjacentHTML('beforeend', topicItemHTML);
      });
    }



    document.addEventListener('DOMContentLoaded', fetchSessionInfo());
  </script>

   <!-- Vendor JS Files -->
   <script src="../assets/vendor/bootstrap/js/bootstrap.bundle.min.js"></script>
   <script src="../assets/vendor/aos/aos.js"></script>
   <script src="../assets/vendor/glightbox/js/glightbox.min.js"></script>
   <script src="../assets/vendor/purecounter/purecounter_vanilla.js"></script>
   <script src="../assets/vendor/swiper/swiper-bundle.min.js"></script>
   <script src="../assets/vendor/isotope-layout/isotope.pkgd.min.js"></script>
   <script src="../assets/vendor/php-email-form/validate.js"></script>
 
   <!-- Main JS File -->
   <script src="../assets/js/main.js"></script>
   <script src="navbar.js"></script>

</body>
</html>
