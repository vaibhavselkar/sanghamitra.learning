<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="utf-8">
  <meta content="width=device-width, initial-scale=1.0" name="viewport">
  <title>Python Basics</title>
  <meta content="" name="description">
  <meta content="" name="keywords">

  <!-- Favicons -->
  <link href="../assets/img/favicon.png" rel="icon">
  <link href="../assets/img/apple-touch-icon.png" rel="apple-touch-icon">

  <!-- Fonts -->
  <link href="https://fonts.googleapis.com" rel="preconnect">
  <link href="https://fonts.gstatic.com" rel="preconnect" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Open+Sans:wght@300;400;500;600;700&family=Poppins:wght@400;500;600;700&display=swap" rel="stylesheet">

  <!-- Vendor CSS Files -->
  <link href="../assets/vendor/bootstrap/css/bootstrap.min.css" rel="stylesheet">
  <link href="../assets/vendor/bootstrap-icons/bootstrap-icons.css" rel="stylesheet">
  <link href="../assets/vendor/aos/aos.css" rel="stylesheet">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.65.16/codemirror.min.css">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.65.16/theme/dracula.css">
  <script src="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.65.16/codemirror.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.65.16/mode/python/python.min.js"></script>
  <link href="../assets/vendor/swiper/swiper-bundle.min.css" rel="stylesheet">

  <!-- Main CSS File -->
  <link href="../assets/css/main.css" rel="stylesheet">
</head>

<style>
  .container h1 {
      text-align: center;
      font-family: "arial", sans-serif;
    }

    .container h2 {
      font-family: 'Comic Sans MS', cursive;
      font-size: 20px;
    }

    .text-success { color: #28a745 !important; }
    .text-danger { color: #dc3545 !important; }
    .bi-1-circle, .bi-2-circle, .bi-3-circle {
      margin-right: 8px;
      font-size: 1.2em;
    }

    .explanation {
      background: #ffffff;
      margin: 1.5rem 0;
      box-shadow: 0 2px 4px rgba(0, 0, 0, 0.05);
    }
 
    code {
      background-color: var(--light-bg);
      padding: 0.2em 0.4em;
      border-radius: 3px;
      font-family: 'Roboto Mono', monospace;
      font-size: 0.9em;
    }

    @media (max-width: 768px) {
      .container {
        padding: 20px;
        margin: 10px;
      }
     
      h1 {
        font-size: 2rem;
      }
    }

    .code-section {
      margin: 1.5rem 0;
      position: relative;
    }

    .CodeMirror {
      border-radius: 8px !important;
      border: 1px solid #e0e0e0 !important;
      font-size: 0.95rem;
      transition: box-shadow 0.3s ease;
    }

    .CodeMirror:hover {
      box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1);
    }

    .output {
      margin-top: 1rem;
      padding: 1rem;
      background-color: #ffffff;
      border: 1px solid #e0e0e0;
      border-radius: 8px;
      white-space: pre-wrap;
      font-family: 'Roboto Mono', monospace;
      font-size: 0.9rem;
      min-height: 50px;
      display: none;
    }

    button {
      padding: 0.8rem 1.5rem;
      background-color: #3498db;
      color: white;
      border: none;
      border-radius: 25px;
      cursor: pointer;
      margin: 1rem 0;
      font-weight: 500;
      transition: all 0.3s ease;
    }

    button:hover {
      background-color: #2980b9;
      transform: translateY(-1px);
      box-shadow: 0 3px 6px rgba(0, 0, 0, 0.1);
    }

    ul {
      padding-left: 1.5rem;
      margin: 1rem 0;
    }

    .guide-content .section {
      background: #f8f9fa;
      border-radius: 8px;
      padding: 20px;
      margin-bottom: 20px;
      box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
    }

    /* Computational Thinking styles */
    .ct-box {
      background: #e8f4fc;
      padding: 20px;
      border-radius: 8px;
      margin: 20px 0;
      border-left: 4px solid #3498db;
    }

    .ct-step {
      padding-left: 25px;
      position: relative;
      margin-bottom: 10px;
    }

    .ct-step-number {
      position: absolute;
      left: 0;
      font-weight: bold;
      color: #3498db;
    }

    .ct-example {
      background: #e8f8f5;
      padding: 15px;
      border-radius: 8px;
      margin: 15px 0;
      border-left: 4px solid #2ecc71;
    }

    .ct-vocab {
      background: #fef9e7;
      padding: 15px;
      border-radius: 8px;
      margin: 20px 0;
      border-left: 4px solid #f39c12;
    }

    .ct-quiz {
      background: #f5eef8;
      padding: 15px;
      border-radius: 8px;
      margin: 20px 0;
    }

    .ct-option {
      padding: 10px;
      margin: 8px 0;
      border-radius: 5px;
      background: #fff;
      cursor: pointer;
      transition: all 0.3s;
      border: 1px solid #ddd;
    }

    .ct-option:hover {
      background-color: #eaf2f8;
      border-color: #3498db;
    }

    .ct-option.selected {
      background-color: #d4e6f1;
      border-left: 4px solid #3498db;
    }

    .ct-feedback {
      padding: 12px;
      margin-top: 15px;
      border-radius: 5px;
      display: none;
    }

    .ct-feedback.correct {
      background-color: #d5f5e3;
      border-left: 4px solid #2ecc71;
    }

    .ct-feedback.incorrect {
      background-color: #fadbd8;
      border-left: 4px solid #e74c3c;
    }

    /* Drag and Drop Styles */
    .draggable-item {
      padding: 10px;
      margin: 5px 0;
      background: #fff;
      border: 1px solid #ddd;
      border-radius: 5px;
      cursor: move;
      transition: all 0.3s;
    }

    .draggable-item:hover {
      background: #f0f0f0;
    }

    .dropzone {
      min-height: 50px;
      padding: 10px;
      margin: 5px 0;
      background: #f8f9fa;
      border: 2px dashed #ccc;
      border-radius: 5px;
      transition: all 0.3s;
    }

    .dropzone.highlight {
      background: #e9f7ef;
      border-color: #28a745;
    }

    .dropzone.correct {
      background: #d4edda;
      border-color: #28a745;
    }

    .dropzone.incorrect {
      background: #f8d7da;
      border-color: #dc3545;
    }

    .alert {
      padding: 10px;
      border-radius: 5px;
      margin-bottom: 15px;
    }

    .alert-success {
      background-color: #d4edda;
      color: #155724;
    }

    .alert-warning {
      background-color: #fff3cd;
      color: #856404;
    }

    .ct-concept-icon {
      font-size: 1.5rem;
      margin-right: 10px;
      color: #3498db;
    }

    .question-numbers {
      display: grid;
      grid-template-columns: repeat(5, 1fr);
      gap: 8px;
      margin-top: 15px;
    }

    .question-num-btn {
      width: 40px;
      height: 40px;
      padding: 0;
      display: flex;
      align-items: center;
      justify-content: center;
      font-weight: 500;
      border-radius: 4px;
    }

    .question-num-btn.active {
      background-color: #3498db;
      color: white;
      border-color: #3498db;
    }

    .question-num-btn.btn-success {
      background-color: #28a745;
      color: white;
      border-color: #28a745;
    }

    .question-num-btn.btn-danger {
      background-color: #dc3545;
      color: white;
      border-color: #dc3545;
    }

    .container .guide-content .section .ct-quiz .ct-option.correct-option {
      background-color: #d5f5e3;
      border-left: 4px solid #2ecc71;
    }

    .container .guide-content .section .ct-quiz .ct-option.incorrect {
      background-color: #fadbd8;
      border-left: 4px solid #e74c3c;
    }

    .container .guide-content .section .ct-quiz .ct-option.selected.correct {
      background-color: #d5f5e3;
      border-left: 4px solid #2ecc71;
    }

    /* Dynamic Quiz Styles - Keep existing selectors */
    #quiz-container .ct-option.correct-option {
      background-color: #d5f5e3;
      border-left: 4px solid #2ecc71;
    }

    #quiz-container .ct-option.incorrect {
      background-color: #fadbd8;
      border-left: 4px solid #e74c3c;
    }

    /* Additional styles to make the check answer function work better */
    .ct-quiz .ct-feedback {
      padding: 12px;
      margin-top: 15px;
      border-radius: 5px;
      display: none;
    }

    .ct-quiz .ct-option.correct {
      background-color: #d5f5e3;
      border-left: 4px solid #2ecc71;
    }

    /* Make sure buttons are properly styled */
    .ct-quiz .ct-btn {
      padding: 0.6rem 1.2rem;
      background-color: #3498db;
      color: white;
      border: none;
      border-radius: 5px;
      cursor: pointer;
      margin: 1rem 0;
      font-weight: 500;
      transition: all 0.3s ease;
    }

    .ct-quiz .ct-btn:hover {
      background-color: #2980b9;
    }


    .ct-option {
      padding: 12px 15px;
      margin: 10px 0;
      border-radius: 8px;
      background: #fff;
      cursor: pointer;
      transition: all 0.3s;
      border: 1px solid #ddd;
    }

    .ct-option:hover {
      background-color: #eaf2f8;
      border-color: #3498db;
    }

    .ct-option.selected {
      background-color: #d4e6f1;
      border-left: 4px solid #3498db;
    }

    .question-numbers {
      display: grid;
      grid-template-columns: repeat(5, minmax(0, 1fr));
      gap: 4px; /* Reduced from 8px to 4px */
      margin-top: 15px;
    }

    .question-num-btn {
      width: 38px; /* Slightly smaller */
      height: 38px; /* Slightly smaller */
      padding: 0;
      display: flex;
      align-items: center;
      justify-content: center;
      font-weight: 500;
      border-radius: 4px;
      font-size: 0.9rem; /* Slightly smaller font */
    }

    #quiz-container .ct-option.incorrect {
      background-color: #fadbd8;
      border-left: 4px solid #e74c3c;
    }


    .ct-quiz .ct-option.incorrect {
      background-color: #fadbd8;
      border-left: 4px solid #e74c3c;
    }

    @media (max-width: 768px) {
      .question-numbers {
        grid-template-columns: repeat(6, 1fr);
      }
      
      .col-md-8, .col-md-4 {
        width: 100%;
      }
      
      .question-numbers-container {
        margin-top: 20px;
      }
    }

</style>

<body>

  <!-- Header Section -->
  <header id="header" class="header d-flex align-items-center sticky-top">
    <div class="container-fluid container-xl position-relative d-flex align-items-center">
      <a href="../index.html" class="logo d-flex align-items-center me-auto">
        <h1><img src="../img/sbi.logo.png" alt="company logo" width="80" height="80">Sanghamitra Learning</h1>
      </a>

      <nav id="navmenu" class="navmenu">
        <div id="navbar-placeholder"></div>
        <i class="mobile-nav-toggle d-xl-none bi bi-list"></i>
      </nav>
    </div>
  </header>

  <!-- Main Content -->
  <main class="main">
    <div class="page-title" data-aos="fade">
      <div class="heading">
        <div class="container">
          <div class="row d-flex justify-content-center text-center">
            <div class="col-lg-8">
              <h1>Computational Thinking</h1>
              <p class="mb-0">Advanced programming concepts using real life examples</p>
            </div>
          </div>
        </div>
      </div>
      <nav class="breadcrumbs">
        <div class="container">
          <ol>
            <li><a href="../index.html">Home</a></li>
            <li><a href="programming.html">Programming</a></li>
            <li><a href="computational-thinking.html">Computational Thinking</a></li>
            <li class="current">CT Advanced Concepts</li>
          </ol>
        </div>
      </nav>
    </div>

    <!-- Enhanced Loops Section -->
    <div class="container guide-content">
      <div class="section" data-aos="fade-up">
        <h2><i class="bi bi-arrow-repeat"></i> 5. Loops - Repeating Tasks</h2>
    
        <div class="ct-box">
          <div class="ct-vocab">
            <strong>Loops:</strong> Doing something over and over until finished.
          </div>
    
          <div class="explanation">
            <p>Loops help with repetitive work. Like washing dishes until the sink is empty, they do the same action multiple times until done.</p>
          </div>
    
          <div class="ct-example">
            <h3>CT Loop Types:</h3>
    
            <div class="loop-type">
              <div class="alert alert-warning" style="border-left: none;">
                <i class="bi bi-123 ct-concept-icon"></i>
                <strong>Counted Repetition (For Loop):</strong> When you know exactly how many times to repeat
              </div>
              <ol>
                <li class="game-example">
                  <strong>Game Example:</strong> In cricket, the bowler gets exactly 6 attempts (balls) per over - this is a counted loop
                </li>
                <li class="classroom-example">
                  <strong>Classroom Example:</strong> Teacher asking each of 25 students to solve one math problem on the board
                </li>
                <li>
                  <strong>Daily Life:</strong> Eating exactly 3 meals a day (breakfast, lunch, dinner)
                </li>
              </ol>
            </div>
    
            <div class="loop-type">
              <div class="alert alert-warning" style="border-left: none;">
                <i class="bi bi-question-circle ct-concept-icon"></i>
                <strong>Conditional Repetition (While Loop):</strong> When you repeat until something changes
              </div>
              <ol>
                <li class="game-example">
                  <strong>Game Example:</strong> Jumping in a skipping rope game until someone misses a jump
                </li>
                <li class="classroom-example">
                  <strong>Classroom Example:</strong> Solving math problems until the bell rings for next period
                </li>
                <li>
                  <strong>Daily Life:</strong> Brushing your teeth until they feel clean (not for a set time)
                </li>
              </ol>
            </div>
          </div>
    
          <div class="alert alert-success">
            <i class="bi bi-lightbulb"></i> <b>Key Idea:</b> Choose Counted Repetition when you know how many times, Conditional Repetition when you're waiting for something to change.
          </div>
    
          <div class="ct-quiz">
            <div class="quiz-question">When should you use a loop?</div>
            <div class="ct-option correct-option" onclick="selectOption(this)">A) When you need to repeat similar actions</div>
            <div class="ct-option" onclick="selectOption(this)">B) When doing something just once</div>
            <div class="ct-option" onclick="selectOption(this)">C) When every step is completely different</div>
            <div class="ct-option" onclick="selectOption(this)">D) When you want to skip steps</div>
            <button class="ct-btn" onclick="checkAnswer(this)">Check Answer</button>
            <div class="ct-feedback correct">
              <strong>✓ Good!</strong> Loops save time on repetitive work like stirring until mixed.
            </div>
            <div class="ct-feedback incorrect">
              <strong>Think:</strong> What tasks do you repeat until they're finished?
            </div>
          </div>
    
          <!-- Additional MCQs -->
          <div class="ct-quiz">
            <div class="quiz-question">When should you use a While loop?</div>
            <div class="ct-option correct-option" onclick="selectOption(this)">A) When you don’t know how many times an action will be repeated, but you want to keep repeating it until a condition is met</div>
            <div class="ct-option" onclick="selectOption(this)">B) When you know exactly how many times an action will be repeated</div>
            <div class="ct-option" onclick="selectOption(this)">C) When the action should never be repeated</div>
            <div class="ct-option" onclick="selectOption(this)">D) When the action should be repeated exactly 10 times</div>
            <button class="ct-btn" onclick="checkAnswer(this)">Check Answer</button>
            <div class="ct-feedback correct">
              <strong>✓ Correct!</strong> While loops are used when we don't know the exact number of repetitions, but we want to repeat until a condition is met.
            </div>
            <div class="ct-feedback incorrect">
              <strong>Think:</strong> When do you want something to repeat until it satisfies a condition, like continuing until you solve a problem?
            </div>
          </div>
          
    
          <div class="ct-quiz">
            <div class="quiz-question">When should you use a For loop?</div>
            <div class="ct-option correct-option" onclick="selectOption(this)">A) When you know exactly how many times you need to repeat an action</div>
            <div class="ct-option" onclick="selectOption(this)">B) When you want to repeat until a condition is met, but don't know how many times</div>
            <div class="ct-option" onclick="selectOption(this)">C) When you need to perform the same action once</div>
            <div class="ct-option" onclick="selectOption(this)">D) When you want to repeat the action randomly</div>
            <button class="ct-btn" onclick="checkAnswer(this)">Check Answer</button>
            <div class="ct-feedback correct">
              <strong>✓ Exactly!</strong> A For loop is used when you know exactly how many times you need to repeat an action.
            </div>
            <div class="ct-feedback incorrect">
              <strong>Consider:</strong> When do you need to repeat something a specific number of times, like iterating through items in a list?
            </div>
          </div>
          
        </div>
      </div>
    </div>
    
    
    <!-- Enhanced Functions Section -->
    <div class="container guide-content">
      <div class="section" data-aos="fade-up">
        <h2><i class="bi bi-puzzle"></i> 6. Functions - Ready-Made Solutions</h2>
    
        <div class="ct-box">
          <div class="ct-vocab">
            <strong>Functions:</strong> A set of steps you can use again and again. They help us avoid doing the same thing over and over, and let us use the same solution when we face similar problems.
          </div>
    
          <div class="explanation">
            <p>Functions are like machines that take an input, follow a set of steps, and give an output.</p>
            <p><strong>How a Function is Made:</strong> You first decide what task you repeat often. Then, you define what can change (inputs), and what steps you follow (the process) to get the answer (output).</p>
            <p><strong>Real-Life Example 1:</strong> A juice machine takes <em>fruit</em> (input) and gives <em>juice</em> (output).</p>
            <p><strong>Real-Life Example 2:</strong> A washing machine takes <em>dirty clothes</em> (input), follows a cleaning process, and gives <em>clean clothes</em> (output).</p>
            <p><strong>Real-Life Example 3:</strong> In school, a math formula like area = length × width takes two numbers (inputs) and gives an area (output).</p>
          </div>
    
          <div class="ct-example">
            <h3>CT Function Building:</h3>
    
            <div class="function-step">
              <div class="ct-step-number"></div>
              <strong>Identify the Repeatable Task:</strong> What do you do the same way each time?
              <div class="ct-example mt-2">
                <strong>Example:</strong> Your morning routine (wake up → brush teeth → get dressed → eat breakfast)
              </div>
            </div>
    
            <div class="function-step">
              <div class="ct-step-number"></div>
              <strong>Define the Ingredients (Parameters):</strong> What can change each time?
              <div class="ct-example mt-2">
                <strong>Example:</strong> Breakfast choice (could be idli, cereal, or paratha)
              </div>
            </div>
    
            <div class="function-step">
              <div class="ct-step-number"></div>
              <strong>Write the Steps:</strong> The exact sequence that works every time
              <div class="ct-example mt-2 game-example">
                <strong>Game Example:</strong> In a maze game, the player always follows these steps to move to a goal:
                <br>1) Check the current position → 2) Decide the direction (up, down, left, right) → 3) Move one step → 4) Repeat until the goal is reached
                <br><br>
                These same steps are used again and again, no matter where the player starts. This is like a function — you give the current position as input, and it gives the next move as output.
              </div>
            </div>
    
            <div class="function-step">
              <div class="ct-step-number">4</div>
              <strong>Test Your Function:</strong> Try it with different inputs
              <div class="ct-example mt-2 classroom-example">
                <strong>Classroom Example:</strong> A math formula works the same whether you're calculating for circles (πr²) or rectangles (l×w)
              </div>
            </div>
          </div>
    
          <div class="alert alert-success">
            <i class="bi bi-lightbulb"></i> <b>Key Idea:</b> Good functions are like reliable tools - they work the same way every time when given the right inputs.
          </div>
    
          <div class="ct-quiz">
            <div class="quiz-question">What's great about functions?</div>
            <div class="ct-option" onclick="selectOption(this)">A) They make you start over each time</div>
            <div class="ct-option correct-option" onclick="selectOption(this)">B) They let you reuse working solutions</div>
            <div class="ct-option" onclick="selectOption(this)">C) They change randomly</div>
            <div class="ct-option" onclick="selectOption(this)">D) They only work once</div>
            <button class="ct-btn" onclick="checkAnswer(this)">Check Answer</button>
            <div class="ct-feedback correct">
              <strong>✓ Exactly!</strong> Like using the same cookie recipe whenever you want cookies.
            </div>
            <div class="ct-feedback incorrect">
              <strong>Remember:</strong> Functions help avoid repeating work you've already done.
            </div>
          </div>
    
          <div class="ct-quiz">
            <div class="quiz-question">What makes functions different from regular code?</div>
            <div class="ct-option" onclick="selectOption(this)">A) They can only be used once</div>
            <div class="ct-option" onclick="selectOption(this)">B) They must be written in a different language</div>
            <div class="ct-option correct-option" onclick="selectOption(this)">C) They can be called multiple times from different places</div>
            <div class="ct-option" onclick="selectOption(this)">D) They automatically delete after running</div>
            <button class="ct-btn" onclick="checkAnswer(this)">Check Answer</button>
            <div class="ct-feedback correct">
              <strong>✓ Exactly!</strong> Functions are like reusable tools in your programming toolbox.
            </div>
            <div class="ct-feedback incorrect">
              <strong>Remember:</strong> The power of functions comes from their reusability.
            </div>
          </div>
    
          <div class="ct-quiz">
            <div class="quiz-question">Which is NOT a good reason to use functions?</div>
            <div class="ct-option" onclick="selectOption(this)">A) To avoid rewriting the same code</div>
            <div class="ct-option" onclick="selectOption(this)">B) To make programs more organized</div>
            <div class="ct-option correct-option" onclick="selectOption(this)">C) To make every program unique and unrepeatable</div>
            <div class="ct-option" onclick="selectOption(this)">D) To break complex problems into smaller parts</div>
            <button class="ct-btn" onclick="checkAnswer(this)">Check Answer</button>
            <div class="ct-feedback correct">
              <strong>✓ Good catch!</strong> Functions actually help create repeatable, reliable solutions.
            </div>
            <div class="ct-feedback incorrect">
              <strong>Consider:</strong> Functions are about creating reliable, reusable solutions.
            </div>
          </div>
        </div>
      </div>
      <div class="container guide-content">
        <div class="section" data-aos="fade-up">
          <h2><i class="bi bi-question-circle"></i> Computational Thinking Quiz</h2>
          
          <div id="quiz-container" class="ct-box">
            <div id="quiz-loading">Loading quiz questions...</div>
            
            <div id="quiz-content" style="display:none;">
              <div class="quiz-header">
                <div class="quiz-progress">
                  <span id="question-counter">Question 1 of 30</span>
                  <div class="progress">
                    <div id="progress-bar" class="progress-bar" role="progressbar" style="width: 3%"></div>
                  </div>
                </div>
              </div>
              
              <div class="row mt-4">
                <!-- Quiz content - Left side -->
                <div class="col-md-8">
                  <div id="question-container">
                    <h3 id="question-text">Question text will appear here</h3>
                    <div id="options-container" class="mt-3">
                      <!-- Options will be populated here -->
                    </div>
                  </div>
                  
                  <div id="explanation-container" class="mt-3" style="display:none;">
                    <div class="alert" id="answer-feedback">
                      Feedback will appear here
                    </div>
                    <div class="alert alert-info" id="explanation-text">
                      Explanation will appear here
                    </div>
                  </div>
                  
                  <div class="quiz-navigation mt-4">
                    <button id="prev-btn" class="btn btn-outline-primary" disabled>Previous</button>
                    <button id="next-btn" class="btn btn-outline-primary">Next</button>
                  </div>
                  
                  <div class="quiz-actions mt-4">
                    <button id="check-answer-btn" class="btn btn-success">Check Answer</button>
                  </div>
                </div>
                
                <!-- Question numbers - Right side -->
                <div class="col-md-4">
                  <div class="question-numbers-container p-3 border rounded">
                    <h4>Question Navigator</h4>
                    <div class="question-numbers" id="question-navigator">
                      <!-- Question number buttons will be populated here -->
                    </div>
                  </div>
                </div>
              </div>
              
              <div id="quiz-results" class="mt-4" style="display:none;">
                <h3>Quiz Results</h3>
                <div class="alert alert-info">
                  <p>You scored: <span id="score-display">0</span> out of 30</p>
                  <div class="progress mt-2">
                    <div id="score-progress" class="progress-bar" role="progressbar" style="width: 0%"></div>
                  </div>
                </div>
                <button id="retry-quiz-btn" class="btn btn-outline-primary mt-2">Try Again</button>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
    
  </main>

    <div class="container copyright text-center mt-4">
      <p>© <span>Copyright</span> <strong class="px-1">Sanghamitra Learning</strong> <span>All Rights Reserved</span></p>
      <div class="credits">
        Designed by <a href="">Sanghamitra</a>
      </div>
    </div>
  </footer>

  <script>

    let username = null;
    let email = null;
    let quizState = {
      questions: [],
      currentQuestionIndex: 0,
      userAnswers: Array(30).fill(null),
      answersChecked: Array(30).fill(false),
      score: 0
    };

    // Check if user is logged in and fetch their previous quiz attempts
    async function fetchSessionInfo() {
      try {
        const sessionResponse = await fetch('https://sanghamitra-learnworld.vercel.app/api/session-info', { 
          credentials: 'include' 
        });
        
        if (sessionResponse.ok) {
          const sessionData = await sessionResponse.json();
          email = sessionData.email;
          username = sessionData.username;
          window.username = username;
          window.email = email;
          
          // Initialize quiz and fetch user's previous answers
          await initializeQuiz();
          await fetchPreviousAnswers();
        } else {
          window.location.href = 'user_login.html';
        }
      } catch (error) {
        console.error('Error fetching session info:', error);
        showError('Failed to get session information. Please refresh or log in again.');
      }
    }

    // Function to fetch user's previous answers for this topic
    async function fetchPreviousAnswers() {
      try {
        const response = await fetch(`https://sanghamitra-learnworld.vercel.app/api/CT_finger_scores/${email}/CT_foundation_2`, {
          credentials: 'include'
        });
        
        if (response.ok) {
          const data = await response.json();
          
          // Get answers from all quiz attempts
          if (data.quizzes && data.quizzes.length > 0) {
            // Create a map of all answered questions using questionId as key
            const answeredQuestions = new Map();
            
            // Process all quiz attempts, newest first for potential duplicates
            const sortedQuizzes = data.quizzes.sort((a, b) => 
              new Date(b.date) - new Date(a.date)
            );
            
            // Reset score before restoring
            quizState.score = 0;
            
            // Go through all quizzes and collect answers
            sortedQuizzes.forEach(quiz => {
              quiz.answers.forEach(answer => {
                // Only add if not already added (from a newer attempt)
                if (!answeredQuestions.has(answer.questionId)) {
                  answeredQuestions.set(answer.questionId, answer);
                  
                  // Find the index of this question in our current quiz
                  const questionIndex = quizState.questions.findIndex(q => q.id === answer.questionId);
                  
                  if (questionIndex !== -1) {
                    // Store the user's answer
                    quizState.userAnswers[questionIndex] = answer.userAnswer;
                    quizState.answersChecked[questionIndex] = true;
                    
                    // Update score if correct
                    if (answer.isCorrect) {
                      quizState.score++;
                    }
                  }
                }
              });
            });
            
            // Update display
            displayQuestion(quizState.currentQuestionIndex);
            updateQuestionNavigator();
            
            // Show Submit button if all questions have been answered
            const allAnswered = quizState.answersChecked.every(Boolean);
            document.getElementById('submit-quiz-btn').style.display = allAnswered ? 'inline-block' : 'none';
          }
        }
      } catch (error) {
        console.error('Error fetching previous answers:', error);
        // Continue with quiz without previous answers
      }
    }
    

    // Function to handle option selection in static examples
    function selectOption(option) {
      const questionDiv = option.closest('.ct-quiz');
      const options = questionDiv.querySelectorAll('.ct-option');

      // Remove selected class from all options
      options.forEach(opt => {
        opt.classList.remove('selected');
      });

      // Add selected class to clicked option
      option.classList.add('selected');
    }

    // Improved function to check answers in static examples
    function checkAnswer(button) {
      const questionDiv = button.closest('.ct-quiz');
      const selectedOption = questionDiv.querySelector('.ct-option.selected');
      const correctOption = questionDiv.querySelector('.correct-option');
      const correctFeedback = questionDiv.querySelector('.ct-feedback.correct');
      const incorrectFeedback = questionDiv.querySelector('.ct-feedback.incorrect');

      // Hide all feedback first
      if (correctFeedback) correctFeedback.style.display = 'none';
      if (incorrectFeedback) incorrectFeedback.style.display = 'none';

      // Reset existing visual feedback
      questionDiv.querySelectorAll('.ct-option').forEach(opt => {
        opt.classList.remove('correct', 'incorrect');
      });

      if (selectedOption) {
        if (selectedOption === correctOption) {
          // Correct answer
          correctFeedback.style.display = 'block';
          selectedOption.classList.add('correct');
        } else {
          // Incorrect answer
          incorrectFeedback.style.display = 'block';
          selectedOption.classList.add('incorrect');
          correctOption.classList.add('correct-option'); // Make sure correct option is styled
        }
      } else {
        alert('Please select an answer first!');
      }
    }

    // Initialize the quiz
    async function initializeQuiz() {
      try {
        // Fetch questions from the API
        const response = await fetch('https://sanghamitra-learnworld.vercel.app/api/CT_finger?topic=CT_foundation2');
        
        if (!response.ok) {
          throw new Error('Failed to fetch quiz questions');
        }
        
        const data = await response.json();
        
        // Make sure we have questions
        quizState.questions = data.data;
        
        if (quizState.questions.length < 30) {
          throw new Error('Not enough questions available');
        }
        
        // Initialize arrays based on actual question count
        quizState.userAnswers = Array(quizState.questions.length).fill(null);
        quizState.answersChecked = Array(quizState.questions.length).fill(false);
        
        // Hide loading, show quiz content
        document.getElementById('quiz-loading').style.display = 'none';
        document.getElementById('quiz-content').style.display = 'block';
        
        // Set up question navigation
        setupQuestionNavigation();
        
        // Display the first question
        displayQuestion(0);
        
      } catch (error) {
        console.error('Error initializing quiz:', error);
        document.getElementById('quiz-loading').innerHTML = `
          <div class="alert alert-danger">
            Failed to load quiz: ${error.message}. Please refresh the page to try again.
          </div>
        `;
      }
    }

    // Set up question navigation buttons
    function setupQuestionNavigation() {
      const navigator = document.getElementById('question-navigator');
      navigator.innerHTML = '';
      
      for (let i = 0; i < quizState.questions.length; i++) {
        const button = document.createElement('button');
        button.textContent = i + 1;
        button.className = 'btn btn-outline-secondary question-num-btn';
        button.dataset.index = i;
        
        // Mark current question
        if (i === quizState.currentQuestionIndex) {
          button.classList.add('active');
        }
        
        button.addEventListener('click', () => {
          navigateToQuestion(i);
        });
        
        navigator.appendChild(button);
      }
      
      // Set up navigation button handlers
      document.getElementById('next-btn').addEventListener('click', () => {
        navigateToQuestion(quizState.currentQuestionIndex + 1);
      });
      
      document.getElementById('prev-btn').addEventListener('click', () => {
        navigateToQuestion(quizState.currentQuestionIndex - 1);
      });
      
      document.getElementById('check-answer-btn').addEventListener('click', checkQuizAnswer);
      document.getElementById('submit-quiz-btn').addEventListener('click', submitQuiz);
      document.getElementById('retry-quiz-btn').addEventListener('click', resetQuiz);
      
      // Update navigator to show answered questions
      updateQuestionNavigator();
    }

    // Update the question navigator to show progress
    function updateQuestionNavigator() {
      const questionButtons = document.querySelectorAll('.question-num-btn');
      
      // Update the statistics display at the top
      const answeredCount = quizState.answersChecked.filter(Boolean).length;
      const correctCount = quizState.score;
      
      // Add a progress summary if it doesn't exist
      if (!document.getElementById('quiz-progress-summary')) {
        const summaryDiv = document.createElement('div');
        summaryDiv.id = 'quiz-progress-summary';
        summaryDiv.className = 'alert alert-info mt-2 mb-3';
        document.querySelector('.question-numbers-container h4').after(summaryDiv);
      }
      
      // Update the progress summary - show completed/total and correct/total
      document.getElementById('quiz-progress-summary').innerHTML = `
        <div><strong>Completed:</strong> ${answeredCount}/${quizState.questions.length}</div>
        <div><strong>Correct:</strong> ${correctCount}/${answeredCount}</div>
      `;
      
      // Update the buttons
      questionButtons.forEach(btn => {
        const btnIndex = parseInt(btn.dataset.index);
        // Reset all classes first
        btn.classList.remove('active', 'btn-primary', 'btn-success', 'btn-danger');
        
        // Mark current question
        if (btnIndex === quizState.currentQuestionIndex) {
          btn.classList.add('active', 'btn-primary');
        } 
        // Mark answered questions based on correctness
        else if (quizState.answersChecked[btnIndex]) {
          const isCorrect = quizState.userAnswers[btnIndex] === quizState.questions[btnIndex].correctAnswer;
          if (isCorrect) {
            btn.classList.add('btn-success');
          } else {
            btn.classList.add('btn-danger');
          }
        }
      });
    }

    // Display a question by index
    function displayQuestion(index) {
      if (index < 0 || index >= quizState.questions.length) {
        return;
      }
      
      // Update current question index
      quizState.currentQuestionIndex = index;
      
      // Update question counter and progress bar
      document.getElementById('question-counter').textContent = `Question ${index + 1} of ${quizState.questions.length}`;
      document.getElementById('progress-bar').style.width = `${((index + 1) / quizState.questions.length) * 100}%`;
      
      // Get current question
      const question = quizState.questions[index];
      
      // Display question text
      document.getElementById('question-text').textContent = question.question;
      
      // Reset and populate options
      const optionsContainer = document.getElementById('options-container');
      optionsContainer.innerHTML = '';
      
      question.options.forEach((option, optionIndex) => {
        const optionElement = document.createElement('div');
        optionElement.className = 'ct-option';
        optionElement.textContent = option;
        optionElement.dataset.index = optionIndex;
        
        // If this question has been answered, show the selection
        if (quizState.userAnswers[index] === optionIndex) {
          optionElement.classList.add('selected');
        }
        
        // Add correct/incorrect classes if answer has been checked
        if (quizState.answersChecked[index]) {
          if (optionIndex === question.correctAnswer) {
            optionElement.classList.add('correct-option');
          } 
          if (quizState.userAnswers[index] === optionIndex && 
              optionIndex !== question.correctAnswer) {
            optionElement.classList.add('incorrect');
          }
        }
        
        optionElement.addEventListener('click', () => {
          // Only allow selection if answer hasn't been checked
          if (!quizState.answersChecked[index]) {
            selectQuizOption(optionElement);
          }
        });
        
        optionsContainer.appendChild(optionElement);
      });
      
      // Show/hide explanation
      const explanationContainer = document.getElementById('explanation-container');
      if (quizState.answersChecked[index]) {
        document.getElementById('check-answer-btn').disabled = true;
        explanationContainer.style.display = 'block';
        const isCorrect = quizState.userAnswers[index] === question.correctAnswer;
        
        document.getElementById('answer-feedback').className = isCorrect ? 
          'alert alert-success' : 'alert alert-danger';
        document.getElementById('answer-feedback').innerHTML = isCorrect ?
          '✔️ Correct! Great job!' : '❌ Not quite right.';
        document.getElementById('explanation-text').textContent = question.explanation;
      } else {
        explanationContainer.style.display = 'none';
      }
      
      // Update navigation buttons state
      document.getElementById('prev-btn').disabled = index === 0;
      document.getElementById('next-btn').disabled = index === quizState.questions.length - 1;
      
      // Update question navigator buttons
      updateQuestionNavigator();
      
      // Show Submit button if all questions have been answered
      const allAnswered = quizState.answersChecked.every(Boolean);
      document.getElementById('submit-quiz-btn').style.display = allAnswered ? 'inline-block' : 'none';
      
      // Show/hide Check Answer button based on if user selected an answer and hasn't checked yet
      document.getElementById('check-answer-btn').disabled = 
        quizState.userAnswers[index] === null || quizState.answersChecked[index];
    }

    // Navigate to a specific question
    function navigateToQuestion(index) {
      if (index >= 0 && index < quizState.questions.length) {
        displayQuestion(index);
      }
    }

    // Select an option for the current question
    function selectQuizOption(optionElement) {
      // Remove selected class from all options
      const options = document.querySelectorAll('.ct-option');
      options.forEach(opt => opt.classList.remove('selected'));
      
      // Add selected class to clicked option
      optionElement.classList.add('selected');
      
      // Store user answer
      const optionIndex = parseInt(optionElement.dataset.index);
      quizState.userAnswers[quizState.currentQuestionIndex] = optionIndex;
      
      // Enable check answer button
      document.getElementById('check-answer-btn').disabled = false;
    }

    // Check the answer for the current question and save progress
    async function checkQuizAnswer() {
      const currentIndex = quizState.currentQuestionIndex;
      const userAnswer = quizState.userAnswers[currentIndex];
      const correctAnswer = quizState.questions[currentIndex].correctAnswer;
      const questionId = quizState.questions[currentIndex].id;
      
      // Mark this question as checked
      quizState.answersChecked[currentIndex] = true;
      
      // Determine if answer is correct
      const isCorrect = userAnswer === correctAnswer;
      
      // Update score if correct
      if (isCorrect) {
        quizState.score++;
      }
      
      // Save this individual answer to the database
      try {
        const result = {
          email: email,
          username: username,
          topic: 'CT_foundation_2',
          score: isCorrect ? 1 : 0,
          totalQuestions: 1,
          answers: [{
            questionId: questionId,
            userAnswer: userAnswer,
            isCorrect: isCorrect
          }]
        };
        
        // Send to server
        fetch('https://sanghamitra-learnworld.vercel.app/api/CT_finger_scores', {
          method: 'POST',
          headers: {
            'Content-Type': 'application/json'
          },
          body: JSON.stringify(result),
          credentials: 'include'
        });
        
        // Don't wait for response - continue with UI update
      } catch (error) {
        console.error('Error saving answer:', error);
        // Continue anyway - don't block user
      }
      
      // Redisplay question to show correct/incorrect and explanation
      displayQuestion(currentIndex);
      
      // Update question navigator
      updateQuestionNavigator();
      
      // Show Submit button if all questions have been answered
      const allAnswered = quizState.answersChecked.every(Boolean);
      
      document.getElementById('submit-quiz-btn').style.display = 
        allAnswered ? 'inline-block' : 'none';
    }

    // Submit the quiz and show results
    async function submitQuiz() {
      // Show quiz results
      document.getElementById('score-display').textContent = quizState.score;
      document.getElementById('score-progress').style.width = `${(quizState.score / quizState.questions.length) * 100}%`;
      document.getElementById('quiz-results').style.display = 'block';
      
      // Hide navigation and check button
      document.getElementById('check-answer-btn').style.display = 'none';
      document.getElementById('submit-quiz-btn').style.display = 'none';
      
      try {
        // Prepare comprehensive quiz results
        const result = {
          email: email,
          username: username,
          topic: 'CT_foundation_2',
          score: quizState.score,
          totalQuestions: quizState.questions.length,
          date: new Date().toISOString(),
          answers: quizState.questions.map((question, index) => ({
            questionId: question.id,
            userAnswer: quizState.userAnswers[index],
            isCorrect: quizState.userAnswers[index] === question.correctAnswer
          }))
        };
        
        // Send complete results to server
        const response = await fetch('https://sanghamitra-learnworld.vercel.app/api/CT_finger_scores', {
          method: 'POST',
          headers: {
            'Content-Type': 'application/json'
          },
          body: JSON.stringify(result),
          credentials: 'include'
        });
        
        if (!response.ok) {
          throw new Error('Failed to save quiz results');
        }
        
        console.log('Complete quiz results saved successfully');
      } catch (error) {
        console.error('Error saving complete quiz results:', error);
        // Show error message to user
        alert('There was a problem saving your quiz results. Please try again later.');
      }
    }

    // Reset the quiz to start over
    function resetQuiz() {
      quizState = {
        questions: quizState.questions,
        currentQuestionIndex: 0,
        userAnswers: Array(quizState.questions.length).fill(null),
        answersChecked: Array(quizState.questions.length).fill(false),
        score: 0
      };
      
      // Reset UI
      document.getElementById('quiz-results').style.display = 'none';
      document.getElementById('check-answer-btn').style.display = 'inline-block';
      document.getElementById('submit-quiz-btn').style.display = 'none';
      
      // Display first question
      displayQuestion(0);
      
      // Reset navigation
      updateQuestionNavigator();
    }

    // Show error message
    function showError(message) {
      const quizLoading = document.getElementById('quiz-loading');
      if (quizLoading) {
        quizLoading.innerHTML = `
          <div class="alert alert-danger">
            ${message}
          </div>
        `;
      } else {
        alert(message);
      }
    }

    // Initialize quiz when page loads
    document.addEventListener('DOMContentLoaded', function() {
      fetchSessionInfo();
    });
    
  </script>

  <!-- Scroll Top -->
  <a href="#" id="scroll-top" class="scroll-top d-flex align-items-center justify-content-center"><i class="bi bi-arrow-up-short"></i></a>

  <!-- Vendor JS Files -->
  <script src="../assets/vendor/bootstrap/js/bootstrap.bundle.min.js"></script>
  <script src="../assets/vendor/php-email-form/validate.js"></script>
  <script src="../assets/vendor/aos/aos.js"></script>
  <script src="../assets/vendor/glightbox/js/glightbox.min.js"></script>
  <script src="../assets/vendor/purecounter/purecounter_vanilla.js"></script>
  <script src="../assets/vendor/swiper/swiper-bundle.min.js"></script>

  <!-- Main JS File -->
  <script src="../assets/js/main.js"></script>
  <script src="navbar.js"></script>
</body>
</html>
